//  Generated by Generamba
//
//  MainScreenMainScreenViewModel.swift
//  Wakeapper
//
//  Created by Sergey Borovikov on 30/09/2018.
//  Copyright Â© 2018 Company. All rights reserved.
//

import Foundation
import RxCocoa
import RxSwift

protocol MainScreenViewModelI {
    
    // Input
    func onButton()
    
    // Output
    var wakeupDetectorType: Observable<WakeupDetectorType> { get }
    var moveDetection: Observable<Void> { get }
    var bigTimerObservable: Observable<Int> { get }
    var activityHistory: Single<Void> { get }
}

final class MainScreenViewModel {

    private let _wakeUpDetectorService: WakeupDetectorServiceI!
    private let _activityHistoryService: ActivityHistoryServiceI!
    
    init(wakeUpDetectorService: WakeupDetectorServiceI,
         activityHistoryService: ActivityHistoryServiceI) {
        _wakeUpDetectorService = wakeUpDetectorService
        _activityHistoryService = activityHistoryService
    }
}

extension MainScreenViewModel: MainScreenViewModelI {

    func onButton() {
        _wakeUpDetectorService?.startWakupDetection()
    }

    var wakeupDetectorType: Observable<WakeupDetectorType> { return _wakeUpDetectorService.wakeupDetectorType }
    var moveDetection: Observable<Void> { return _wakeUpDetectorService.moveDetection }
    var bigTimerObservable: Observable<Int> { return _wakeUpDetectorService.bigTimerObservable }
    var activityHistory: Single<Void> { return _activityHistoryService.activityHistorySingle(forLastMins: 1, smallTimePeriodInSec: 20) }
}
